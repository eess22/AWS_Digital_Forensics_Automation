# AWS_Digital_Forensics_Automation

이 프로젝트는 AWS 환경에서 침해 사고 발생 시 디지털 포렌식 자동화 시스템을 구축하는 데 목적이 있습니다. GuardDuty 경고를 기점으로 Step Functions를 통한 자동화된 대응 및 분석을 수행합니다.

## 프로젝트 개요
 - 상황: 두 개의 가용 영역(AZ1, AZ2)으로 분산된 EC2 환경에서 AZ2 인스턴스가 침해됨
 - 목표: 실시간 위협 탐지 후, 포렌식 수집 및 분석을 자동화하여 빠른 대응 및 보고 체계를 구현
  
 ## 구성도

<img width="975" alt="스크린샷 2025-05-22 10 02 46" src="https://github.com/user-attachments/assets/fbecd5b4-a301-4a27-aa8d-b6b5b2467fce" />


##  공격 및 포렌식 핵심 요약

###  1. 공격 개요

- **공격 유형**: Command Injection
- **침투 경로**: ALB 뒤에 위치한 DVWA 웹 서버
- **권한 탈취**: 웹 서버 루트 권한 및 IMDSv1을 통한 IAM 권한 탈취
- **후속 행위**:
  - IAM 사용자 생성 및 AWS 콘솔 접근
  - 악성 스크립트 실행 (web_user_log.py, pcap.py 등)
  - 비트코인 채굴기 설치 (cpuminer)
  - 포렌식 회피를 위한 로그 삭제 및 히스토리 제거

---

###  2. 포렌식 자동화 프로세스 (L1~L7)

| 단계 | 설명 |
|------|------|
| **L1: 초기 대응** | GuardDuty 탐지 → EventBridge 트리거 → Step Functions 실행 |
| **L1-1** | SES를 통해 침해 경고 메일 발송 |
| **L1-2** | NACL 및 보안 그룹을 통해 악성 IP 차단 |
| **L1-3** | 휘발성 데이터 수집 (메모리, 세션, 프로세스 등) |
| **L2** | 수집된 휘발성 데이터 분석 (S3 저장 후 자동 분석) |
| **L3** | 침해된 인스턴스 격리 (보안 그룹 차단) |
| **L4** | EBS 스냅샷 생성 (비휘발성 데이터 보존용) |
| **L5** | 별도 인스턴스에서 비휘발성 데이터 수집 (로그, 파일 등) |
| **L6** | 전체 데이터 종합 분석 (결과 S3 저장) |
| **L7** | 분석 결과를 SES로 관리 담당자에게 전송 |

---

##  사용된 AWS 서비스

| 서비스 | 용도 |
|--------|------|
| EC2    | 대상 인스턴스(amazon linux)|
| ALB    | 사용자 트래픽 분산 |
| NACL   | 악성 IP 차단 |
| S3     | 로그 및 분석 결과 저장 |
| SES    | 관리자 알림 발송 |
| EBS    | 디스크 스냅샷 및 분석용 볼륨 |
| Step Functions | 전체 자동화 워크플로우 실행 |
| Lambda | 세부 작업 자동 실행 |

---
